<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="JWT" />
<meta property="og:locale" content="en" />
<meta name="description" content="프로젝트 중에 JWT를 사용하여서 잘 몰라서.. 공부하고자" />
<meta property="og:description" content="프로젝트 중에 JWT를 사용하여서 잘 몰라서.. 공부하고자" />
<link rel="canonical" href="http://localhost:4000/posts/spring-jwt/" />
<meta property="og:url" content="http://localhost:4000/posts/spring-jwt/" />
<meta property="og:site_name" content="winnie’s Tech Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-07-02T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="JWT" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-10-08T00:54:57+08:00","datePublished":"2024-07-02T00:00:00+08:00","description":"프로젝트 중에 JWT를 사용하여서 잘 몰라서.. 공부하고자","headline":"JWT","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/spring-jwt/"},"url":"http://localhost:4000/posts/spring-jwt/"}</script>
<!-- End Jekyll SEO tag -->


  <title>JWT | winnie's Tech Blog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="winnie's Tech Blog">
<meta name="application-name" content="winnie's Tech Blog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.6.0/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.29.0/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- JavaScript -->

  
    <!-- Switch the mode between dark and light. -->

<script type="text/javascript">
  class ModeToggle {
    static get MODE_KEY() {
      return 'mode';
    }
    static get MODE_ATTR() {
      return 'data-mode';
    }
    static get DARK_MODE() {
      return 'dark';
    }
    static get LIGHT_MODE() {
      return 'light';
    }
    static get ID() {
      return 'mode-toggle';
    }

    constructor() {
      let self = this;this.sysDarkPrefers.addEventListener('change', () => {
        if (self.hasMode) {
          self.clearMode();
        }
        self.notify();
      });

      if (!this.hasMode) {
        return;
      }

      if (this.isDarkMode) {
        this.setDark();
      } else {
        this.setLight();
      }
    }

    get sysDarkPrefers() {
      return window.matchMedia('(prefers-color-scheme: dark)');
    }

    get isPreferDark() {
      return this.sysDarkPrefers.matches;
    }

    get isDarkMode() {
      return this.mode === ModeToggle.DARK_MODE;
    }

    get hasMode() {
      return this.mode != null;
    }

    get mode() {
      return sessionStorage.getItem(ModeToggle.MODE_KEY);
    }get modeStatus() {
      if (this.hasMode) {
        return this.mode;
      } else {
        return this.isPreferDark ? ModeToggle.DARK_MODE : ModeToggle.LIGHT_MODE;
      }
    }

    setDark() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE);
    }

    setLight() {
      document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE);
      sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE);
    }

    clearMode() {
      document.documentElement.removeAttribute(ModeToggle.MODE_ATTR);
      sessionStorage.removeItem(ModeToggle.MODE_KEY);
    }notify() {
      window.postMessage(
        {
          direction: ModeToggle.ID,
          message: this.modeStatus
        },
        '*'
      );
    }

    flipMode() {
      if (this.hasMode) {
        this.clearMode();
      } else {
        if (this.isPreferDark) {
          this.setLight();
        } else {
          this.setDark();
        }
      }

      this.notify();
    }
  }

  const modeToggle = new ModeToggle();
</script>

  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/pinggu.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">winnie's Tech Blog</a>
    <p class="site-subtitle fst-italic mb-0">Why? 생각하자</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/byunyourim"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['byourim','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>JWT</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->





<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  




<!-- return -->




<article class="px-1">
  <header>
    <h1 data-toc-skip>JWT</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1719849600"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jul  2, 2024
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          Updated
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1728320097"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Oct  8, 2024
</time>

        </span>
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://twitter.com/username">winnie</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="2885 words"
>
  <em>16 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  <div class="content">
    <p>프로젝트 중에 JWT를 사용하여서
잘 몰라서.. 공부하고자</p>

<p><br /></p>

<p>HTTP 프로토콜은 웹에서 클라이언트와 서버 간의 통신을 가능하게 하는 기본적인 규약이다.<br />
그러나 이 프로토콜은 connectionless(연결이 끊어짐)하고 stateless(상태 비저장) 특성을 갖는다. 즉,
한 번의 통신이 끝나면 연결이 끊어지고, 이후 요청에서 이전 상태를 기억하지 않기 때문에 매번 사용자 인증과정을 반복해야 한다는 단점이 있다.</p>

<p>전통적인 세션 관리 방식은 서버에 사용자의 상태를 저장하고, 클라이언트가 쿠키를 통해 세션 ID를 전송하여 이를 식별한다.<br />
그러나 이 방식은 사용자가 많아질 경우 서버에 부하를 줄 수 있고, 여러 서버를 사용할 때는 세션 공유 문제가 발생할 수 있다.</p>

<p>그러던 중 RESTful API와 같은 상태 비저장(stateless) 아키텍처의 필요성이 커지면서, 서버가 클라이언트의
상태를 관리하지 않고도 인증을 처리할 수 있는 방식이 필요해 졌다.</p>

<p>그때, JWT가 등장하였다.</p>

<p>JWT는 사용자 정보를 포함하는 JSON 형식의 토큰으로, 클라이언트가 서버에 요청할 때 이 토큰을 함께 전송한다.<br />
이 토큰은 서버에서 서명되어 있어, 중간에 변경되지 않았음을 확인한다.. 
덕분에 서버는 상태를 저장할 필요 없이, 클라이언트가 보낸 토큰을 검증하기만 하면 사용자 인증을 수행할 수 있다.</p>

<p>JWT를 통해 사용자 정보를 확인할 수 있고, 다양한 플랫폼과 언어 간의 호환성도 좋다.</p>

<p><br /><br /></p>

<h2 id="jwt-json-web-token"><span class="me-2">JWT (JSON Web Token)</span><a href="#jwt-json-web-token" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>정보를 JSON 형태로 클라이언트에 저장하고 서버는 해당 토큰을 검증하여 인증을 처리하는 방식이다.</p>

<p>토큰 안에 미리 인증에 필요한 정보를 넣어두면 매 요청마다 서버와 통신할 필요가 없다.
이로 인해 서버 부하와 같은 문제를 해결할 수 있다.</p>

<p><br /></p>

<blockquote>
  <h4 id="jwt를-활용한-로그인-프로세스"><span class="me-2">JWT를 활용한 로그인 프로세스</span><a href="#jwt를-활용한-로그인-프로세스" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
  <p><strong>1. [클라이언트의 인증 요청]</strong>     <br />
   사용자가 아이디와 비밀번호를 입력하여 서버에 인증 요청을 보낸다.  <br />
<strong>2. [사용자 정보 유효성 확인]</strong>  <br />
   서버는 데이터베이스와 비교하여 사용자의 정보가 유효한지 확인한다.<br />
<strong>3. [서버 : JWT 생성]</strong><br />
   인증에 성공하면 서버는 사용자의 정보를 기반으로 JWT를 생성한다.<br />
<strong>4. [클라이언트에 JWT 반환]</strong>  <br />
   서버는 생성된 JWT를 클라이언트에 반환한다.<br />
<strong>5. [JWT 저장]</strong>  <br />
클라이언트는 받은 JWT를 세션이나 쿠키에 저장한다.
<br /></p>
  <h4 id="인증-필요한-자원에-접근시"><span class="me-2">인증 필요한 자원에 접근시</span><a href="#인증-필요한-자원에-접근시" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
  <p><strong>6. [인증이 필요한 API 요청]</strong> <br />
   인증이 필요한 API를 호출할 때, Authorization헤더에 JWT를 포함시킨다.<br />
<strong>7. [서버에서 JWT 검증]</strong> <br />
   서버는 요청을 받으면 JWT를 검증한다.  <br />
<strong>8. [리소스 제공]</strong>  <br />
   JWT 가 유효한 경우 서버는 보호된 자원을 사용자에게 반환한다.</p>
</blockquote>

<p><br /><br /><br /></p>

<h2 id="jwt-구조"><span class="me-2">JWT 구조</span><a href="#jwt-구조" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>헤더, 페이로드, 서명 세 부분으로 구성된다.</p>

<p>페이로드는 클레임이라고 불리는 정보 조각을 포함한다.<br />
클레임은 토큰에 추가할 정보를 의미하며 사용자 ID, 권한 정보등이 포함된다.<br />
하지만 디코딩을 통해 들어있는 정보를 확이할 수 있기 때문에 민감한 정보는 포함하지 않는 것이 좋다.</p>

<p>서명은 토큰을 인코딩하거나 유효성 검증을 위해서 사용되는 부분으로,
헤더와 페이로드를 합친 후 비밀키를 사용하여 생성한다.</p>

<h4 id="헤더"><span class="me-2">헤더</span><a href="#헤더" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<ul>
  <li>헤더는 JWT의 메타데이터를 포함하며 일반적으로 토큰의 타입과 사용된 알고리즘 방식을 나타낸다.</li>
  <li>예를 들어, {“alg”: “HS256”, “typ”: “JWT”}와 같이 설정됩니다.</li>
</ul>

<h4 id="페이로드"><span class="me-2">페이로드</span><a href="#페이로드" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<ul>
  <li>실제 데이터가 담긴 부분으로 여러 개의 클레임을 포함한다.</li>
  <li>클레임은 JWT에 담을 정보 조각으로 사용자ID, 권한, 만료 시간 등이 포함된다.</li>
  <li>쉽게 디코딩될 수 있기때문에, 민감한 정보(pw)는 포함하지 않는 것이 좋다.</li>
</ul>

<h4 id="서명"><span class="me-2">서명</span><a href="#서명" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<ul>
  <li>헤더와 페이로드를 합친 후 비밀키를 사용해 생성된다.</li>
  <li>토큰의 무겴성을 검증하는 용도로 사용된다.</li>
  <li>서버는 클라이언트로부터 받은 토큰을 검증하기 위해 서명 부분을 해싱 알고리즘과 비밀키로 다시 생성하고
이를 클라이언트가 전달한 서명과 비교하여, 일치하면 인증이 유효한 것으로 판단한다.</li>
</ul>

<p>이러한 구조로 JWT는 클라이언트와 서버 간의 인증 정보를 안전하게 전송하고, 서버는 상태를 저장하지 않고 사용자를 인증할 수 있다.</p>

<p><br /><br /></p>

<p>JWT는 발급될 때 <strong>유효기간</strong>을 설정하는데, 한 번 발급된 JWT는 그 유효기간이 만료될 때까지 변경할 수 없다.<br />
따라서 유효기간이 짧게 설정되면 로그인을 계속 해야해서 사용자에게 불편을 줄 수 있고, 길게 설정하면 보안이 취약해질 수 있다.</p>

<p>그리고 JWT는 서버에서 상태를 관리하지 않기 때문에, 사용자가 로그아웃하거나, 토큰을 무효화하고자 할 때 즉시 처리하기가 어렵다. <br />
또한 서명되어 있기 때문에 데이터의 변조는 방지할 수 있지만, JWT는 만료될 때까지 사용이 가능하기 때문에, 유효기간이 긴 토큰이 탈취되는 경우 위험하다.</p>

<p>이러한 단점을 보완하기 위해 Access Token과 Refresh Token이 같이 사용된다.</p>

<p><br /><br /><br /></p>

<h2 id="access-token과-refresh-token"><span class="me-2">Access Token과 Refresh Token</span><a href="#access-token과-refresh-token" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="access-token"><span class="me-2">Access Token</span><a href="#access-token" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>Access Token은 사용자가 서버에 요청할 때 전달되는 토큰으로, 짧은 유효기간을 갖는다.
이 토큰은 사용자의 인증과 권한을 검증하는 데 사용되며, 토큰이 만료되면 클라이언트는 더 이상 이 토큰으로 요청할 수 없다.<br />
그러나 유효기간이 짧기 때문에 탈취된 경우에도 큰 피해를 줄 수 있다.</p>

<p><br /></p>

<h3 id="refresh-token"><span class="me-2">Refresh Token</span><a href="#refresh-token" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>Refresh Token은 Access Token의 유효기간이 만료되었을 때 새로운 Access Token을 발급받기 위한 토큰으로 유효기간이 더 길고, 민감한 정보가 포함되지 않는다.
Access Token이 만료되었을 때 클라이언트는 Refresh Token을 서버로 보내 Access Token을 새로 발급받는다.</p>

<p><br /></p>

<blockquote>
  <h4 id="access-token과-refresh-token의-흐름"><span class="me-2">Access Token과 Refresh Token의 흐름</span><a href="#access-token과-refresh-token의-흐름" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
  <p><strong>1. 로그인 시 Access Token과 Refresh Token 발급</strong></p>

  <p><strong>2. 사용자가 로그인하면, 서버는 클라이언트에게 두 개의 토큰을 발급한다.</strong></p>
  <ul>
    <li>짧은 유효기간을 가진 Access Token</li>
    <li>긴 유효기간을 가진 Refresh Token</li>
  </ul>

  <p><strong>3. Access Token을 사용한 요청</strong><br />
사용자는 Access Token을 가지고 API 서버에 요청을 보내며, 서버는 Access Token을 검증하여 유효하면 요청을 처리한다.<br />
Access Token 만료 시 Refresh Token을 이용해 Access Token을 갱신한다.</p>

  <p><strong>4. Access Token 발급</strong><br />
Access Token이 만료되면 클라이언트는 Refresh Token을 서버에 전달하여 새로운 Access Token을 요청한다.<br />
서버는 Refresh Token을 검증한 후, 새로운 Access Token을 발급해 클라이언트에 반환한다.</p>

  <p><strong>5. 로그아웃 또는 Refresh Token 만료</strong>  <br />
사용자가 로그아웃하면, 서버는 Refresh Token을 무효화하는 로직을 실행한다. (블랙리스트) <br />
만약 Refresh Token의 유효기간이 만료되면, 사용자는 다시 로그인을 통해 새로운 Refresh Token을 받아야 한다.</p>
</blockquote>

<p><br /><br /></p>

<h3 id="refresh-token을-사용하는-이유"><span class="me-2">Refresh Token을 사용하는 이유</span><a href="#refresh-token을-사용하는-이유" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Access Token을 짧은 유효기간을 갖도록 해서, 탈취되더라도 그 피해를 최소화할 수 있다. 하지만 짧은 유효기간으로 인해 Access Token이 자주 만료되기 때문에, 매번 재발급받야아 하는 번거로움이 있다.
Refresh Token은 더 긴 유효기간을 가지며, 민감한 정보는 포함하지 않는다. 
그래서 서버는 Access Token이 만료되었을 때, Refresh Token을 사용하여 새로운 Access Token을 발급한다.</p>

<p>이를 통 짧은 유효기간의 Access Token으로 보안을 강화하고, 긴 유효기간의 Refresh Token을 사용하여 사용자 편의성을 유지할 수 있다.</p>

<p><br /><br /><br /></p>

<h2 id="refresh-token-rotation"><span class="me-2">Refresh Token Rotation</span><a href="#refresh-token-rotation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>리프레시 토큰은 한 번 발급되면 장기간 사용할 수 있는 토큰으로, 한 번 탈취되면 계속해서 엑세스 토큰을 발급할 수 있다.</p>

<p>이 위험을 줄이기 위해 리프레스 토큰을 한 번 사용하면, 다시 새로운 리프레시 토큰을 발급하고 이전 토큰을 무효화하도록 한다.
이 방식이 <strong>Refresh Token Rotation</strong> 이다.</p>

<p><br /></p>

<blockquote>
  <h4 id="rtr-흐름"><span class="me-2">RTR 흐름</span><a href="#rtr-흐름" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
  <p><strong>1. 액세스 토큰과 리프레시 토큰 발급</strong><br />
   사용자가 처음 로그인하면 서버는 액세스 토큰과 리프레시 토큰을 클라이언트에게 발급한다.</p>

  <p><strong>2. 액세스 토큰 재발급</strong><br />
 액세스 토큰이 만료되면, 클라이언트는 리프레시 토큰을 사용하여 새로운 액세스 토큰을 요청한다.
 이때, 서버는 클라이언트에게 새로운 액세스 토큰과 새로운 리프레시 토큰을 함께 발급해준다.</p>

  <p><strong>3. 이전 리프레시 토큰을 무효</strong><br />
 새로운 리프레시 토큰이 발급되면 이전 리프레시 토큰은 즉시 무효화되며, 한 번 사용된 리프레시 토큰은 다시 사용할 수 없다.</p>

  <p><strong>4. 탈취 방지</strong>
  리프레시 토큰이 탈취된 경우, 공격자는 그 토큰을 사용하려고 시도한다. <br />
  하지만, 리프레시 토큰이 한 번 사용될 때마다 새로운 토큰으로 교체되기 때문에, 이미 무효화되어 사용할 수 없다.
  따라서, 공격자는 탈취한 토큰으로 다시 액세스 토큰을 발급받을 수 없다.</p>

  <p><strong>5. 서버 측 저장 관리</strong>
  서버는 클라이언트에게 마지막으로 발급된 리프레시 토큰만을 저장하고 관리한다.
  따라서 새로 발급된 리프레시 토큰만 유효하고, 이전의 모든 리프레시 토큰은 사용할 수 없다.</p>
</blockquote>


  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/spring/">Spring</a>
      </div>
    

    <!-- tags -->
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=JWT%20-%20winnie's%20Tech%20Blog&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fspring-jwt%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=JWT%20-%20winnie's%20Tech%20Blog&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fspring-jwt%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fspring-jwt%2F&text=JWT%20-%20winnie's%20Tech%20Blog" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <script src="https://utteranc.es/client.js"
          repo="byunyourim/comments"
          issue-term="pathname"
          theme="github-light"
          crossorigin="anonymous"
          async>
  </script>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/java-blocking/">Blocking IO와 Non-Blocking IO , 동기와 비동기</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/os-%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C/">운영체제의 동작</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/java-threadlocal/">ThreadLocal</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/kboticket-%EB%8C%80%EA%B8%B0%EC%97%B4/">티켓팅 시스템 - 대기열 구현</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/java-gc/">GC(Garbage Collection)란?</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->


















            </div>

            
              
              



  <section id="toc-wrapper" class="d-none ps-0 pe-4">
    <h2 class="panel-heading ps-3 mb-2">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/Spring-DI/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1725552000"
  data-df="ll"
  
>
  Sep  6, 2024
</time>

              <h4 class="pt-0 my-2">DI(Dependency Injection)</h4>
              <div class="text-muted">
                <p>객체지향 프로그래밍에서
객체 간의 의존성을 외부에서 주입하여 객체 간의 결합도를 낮추고, 코드의 재사용성과 유연성을 높이는 패턴

이로써 객체가 스스로 직접 의존성을 생성하거나 관리하는 대신, 외부에서 필요한 의존성을 주입받아서 사용한다.  
객체는 자신이 사용할 객체의 구현을 몰라도 되고, 인터페이스나 추상 타입에 의존한다.

강합 결합?
한 클래스...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/transactional-proxy/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1721145600"
  data-df="ll"
  
>
  Jul 17, 2024
</time>

              <h4 class="pt-0 my-2">Transactional Annotation과 Proxy</h4>
              <div class="text-muted">
                <p>@Transactional은 메서드 실행 전후에 트랜잭션을 시작하고 커밋 또는 롤백하는 기능을 제공하는 어노테이션으로 스프링에서 트랜잭션 관리를 자동으로 처리한다.



트랜잭션 경계 설정

  트랜잭션 시작:
    
      @Transactional이 적용된 메서드를 호출할 때, 먼저 PlatformTransactionManager를 사용하여 ...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/transaction/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1721145600"
  data-df="ll"
  
>
  Jul 17, 2024
</time>

              <h4 class="pt-0 my-2">Transaction</h4>
              <div class="text-muted">
                <p>트랜잭션은 일련의 작업들을 하나로 묶어서 처리하는 단위이다.

트랜잭션이 성공적으로 완료되면 모든 작업이 영구적으로 반영되고, 하나라도 실패하면 모든 작업이 취소된다.
데이터의 일관성과 무결성을 유지하는 중요한 개념이다.



트랜잭션의 특징 (ACID)

  
    Atomicity 원자성 
한 트랜잭션 내의 모든 연산들이 완전히 수행되거나 전혀 ...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/jpa-jpa/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>JPA와 영속성</p>
    </a>
  

  
    <a
      href="/posts/transaction/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Transaction</p>
    </a>
  
</nav>

            
              
              <!-- The comments switcher -->


            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2024</time>

    
      <a href="https://twitter.com/username">winnie</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.1.1"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->


















    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- JavaScripts -->
    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.29.0/dist/tocbot.min.js"></script>







<script src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  







    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5">Oops! No results found.</p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>

