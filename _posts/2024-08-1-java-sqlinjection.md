---
layout: post
title: SQL Injection
categories: DB
---

전송 계층에서 사용하는 두 가지 주요 프로토콜

# SQL Injection
<span style='background-color:#D0E4FC'>**공격자가 보안상의 취약점을 노리고 쿼리에 자신이 작성한 sql 문을 입력하여 데이터베이스가 비정상적으로 동작하도록 하는 공격**</span>  
  
이 공격을 통해 데이터를 유출하거나, 데이터를 조작할 수 있습니다.

### 과정
공격자는 웹 사이트의 입력 필드나 url 파라미터에 sql 인젝션 취약점이 있는지 파악 후, 취약점이 확인되면 쿼리에 악의적인 sql 문을 삽입합니다.
예를 들어 "admin; --" 와 같이 입력함으로써 쿼리를 변경합니다.
이로써 데이터베이스가 의도치 않은 동작을 하게 만들어 사용자의 정보를 유출할 수 있습니다.  
  
이러한 작업을 통해 데이터를 유출할 수 있으며, 특정 사용자의 비밀번호를 변경, 관리자 권한을 얻어 시스텡 서버를 장악할 수 있습니다.
또한 로그인시 비밀번호 검증을 피하여 로그인이 가능합니다.  

## 예방하려면? 
PreparedStatement를 사용하면 드라이버가 자동으로 매개변수 값을 이스케이프 처리하여 SQL Injection 공격을 방지할 수 있습니다.

Hibernate와 같은 ORM 프레임워크를 사용하여 SQL 쿼리 작성을 자동화함으로써 위험을 줄일 수 있습니다.
모든 사용자의 입력을 검증하고 특수문자를 이스케이프 처리합니다.
또한 데이터베이스 권한에 최소한의 권한을 부여하는 것이 좋습니다.  


하지만 SQL 쿼리를 동적으로 생성하는 코드에서 PreparedStatement의 파라미터 바인딩을 적절히 사용하지 않으면 여전히 취약점이 발생할 수 있습니다.
그리고 개발자가 입력 값을 제대로 검증하지 않거나, 특히 입력 값이 코드 또는 쿼리 구조의 일부로 사용되는 경우 공격에 노출될 수 있습니다.

따라서 입력 값의 유형, 길이, 형식 등을 철저히 검증해야 하며, 모든 변수는 반드시 PreparedStatement의 파라미터로 바인딩해야 합니다.
필요에 따라 특수 문자를 이스케이프 처리하고, 입력 값이 SQL 구조에 영향을 주지 않도록 합니다.

이러한 방법을 통해 Sql injection를 예방할 수 있습니다.

